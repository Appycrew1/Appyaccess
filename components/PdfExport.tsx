"use client";
import { jsPDF } from "jspdf";import type { AIResult, AnalysisPayload } from "@/types";import { formatDistance, formatDuration } from "@/lib/utils";
export default function PdfExport({ai,payload}:{ai:AIResult|null,payload:AnalysisPayload|null}){const handle=()=>{const doc=new jsPDF();let y=10;const add=(t:string,s=12,b=false)=>{doc.setFont("helvetica",b?"bold":"normal");doc.setFontSize(s);const lines=doc.splitTextToSize(t,180);doc.text(lines,15,y);y+=(lines.length*(s*.45))+4;};add("AppyAccess — Pre-Survey Report",16,true);if(payload){add(`Origin: ${payload.origin.description}`);add(`Destination: ${payload.destination.description}`);if(payload.route){add(`Route: ${formatDistance(payload.route.distance_m)} / Base ${formatDuration(payload.route.duration_s)} / Traffic ${formatDuration(payload.route.duration_in_traffic_s)}`);}if(payload.weather){add(`Weather: ${payload.weather.temperature}°C, wind ${payload.weather.windspeed} km/h`);}}doc.line(15,y,195,y);y+=6;if(ai){add("Summary",14,true);add(ai.summary);add("Origin vs Destination",14,true);add(ai.originVsDest||"—");add("Crew",14,true);add(ai.crewRecommendation);add("Equipment",14,true);add(ai.equipment.join(", ")||"—");add("Risk Level",14,true);add(ai.riskLevel);add("Key Risks",14,true);add(ai.keyRisks.join("; ")||"—");add("Parking Notes",14,true);add(ai.parkingNotes||"—");add("Compliance Checklist",14,true);ai.complianceChecklist.forEach((c,i)=>add(`${i+1}. ${c}`));add("Auto-generated Checklist",14,true);add(JSON.stringify(ai.autoChecklist));}else{add("No AI analysis yet.",12);}doc.save("appyaccess-report.pdf");};return <button onClick={handle} className="btn btn-ghost">Export PDF</button>;}
