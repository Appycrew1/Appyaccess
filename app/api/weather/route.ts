import { NextResponse } from "next/server";
export async function GET(req:Request){const {searchParams}=new URL(req.url);const lat=searchParams.get("lat"),lng=searchParams.get("lng"),date=searchParams.get("date");if(!lat||!lng||!date)return NextResponse.json({error:"lat, lng, date required"},{status:400});const url=`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lng}&daily=temperature_2m_max,temperature_2m_min,precipitation_sum,wind_speed_10m_max&timezone=auto&start_date=${date}&end_date=${date}`;const r=await fetch(url,{cache:"no-store"});if(!r.ok)return NextResponse.json({error:"Weather fetch failed"},{status:500});const d=await r.json();const out={date,tmax:d?.daily?.temperature_2m_max?.[0]??null,tmin:d?.daily?.temperature_2m_min?.[0]??null,precipitation_mm:d?.daily?.precipitation_sum?.[0]??null,windspeed:d?.daily?.wind_speed_10m_max?.[0]??null};return NextResponse.json(out);}
