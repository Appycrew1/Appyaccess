import OpenAI from "openai";
export async function aiExtract<T>(system:string,input:string,schemaHint:string):Promise<T|null>{if(!process.env.OPENAI_API_KEY)return null;const openai=new OpenAI({apiKey:process.env.OPENAI_API_KEY});const prompt=`Extract the following structured JSON. Only return JSON, no prose.\nSchema hint: ${schemaHint}\n\nCONTENT START\n${input}\nCONTENT END`;const r=await openai.chat.completions.create({model:process.env.OPENAI_MODEL||"gpt-4o-mini",temperature:0,messages:[{role:"system",content:system},{role:"user",content:prompt}]});const text=r.choices[0]?.message?.content?.trim()||"{}";try{return JSON.parse(text) as T;}catch{const m=text.match(/\{[\s\S]*\}$/);if(m)return JSON.parse(m[0]) as T;return null;}}
