export async function fetchEPC(postcode:string){const url=process.env.EPC_API_URL||"https://epc.opendatacommunities.org/api/v1/domestic/search";const token=process.env.EPC_API_TOKEN;if(!token)return null;const u=`${url}?postcode=${encodeURIComponent(postcode)}`;const r=await fetch(u,{headers:{Authorization:`Bearer ${token}`},cache:"no-store"});if(!r.ok)return null;const data=await r.json();const first=Array.isArray(data?.rows)?data.rows[0]:null;if(!first)return null;return{property_type:first?.PROPERTY_TYPE||null,built_form:first?.BUILT_FORM||null,floor_area:first?.TOTAL_FLOOR_AREA?Number(first.TOTAL_FLOOR_AREA):null,energy_rating:first?.CURRENT_ENERGY_RATING||null};}
